# 一种基于GNSS-R与物理模型深度协同的土壤湿度动态估算方法

## 技术领域

本发明属于水文遥感与环境监测技术领域，具体涉及一种通过深度协同全球导航卫星系统反射信号（GNSS-R）遥感、陆面过程物理模型（LSM）以及时空深度学习网络，实现高时空分辨率、高精度土壤湿度动态反演与预测的方法。

## 背景技术

土壤湿度作为连接地表水、地下水与大气水的关键变量，在农业灌溉、水资源管理、气候变化模拟及自然灾害预警中具有不可替代的作用。因此，获取高精度、高时空分辨率的土壤湿度数据具有重大的科学与应用价值。当前的土壤湿度获取方法主要包括地面站点观测、遥感反演和模型模拟，但各自存在显著局限。地面站点观测虽能提供高精度的点测量数据，但其成本高昂且空间代表性差，难以捕捉土壤湿度在空间上的高度异质性。传统遥感技术中，光学与热红外遥感易受云层和大气影响，而微波遥感虽能穿透云层，却面临空间分辨率（被动微波）或信号-地表交互复杂性（主动微波）的挑战。

作为一种新兴的遥感手段，全球导航卫星系统反射信号（GNSS-R）技术因其全天候、高时间分辨率和低成本的优势，在土壤湿度监测中展现出巨大潜力。然而，GNSS-R的反射信号不仅与土壤湿度相关，还受到地表粗糙度、植被含水量等非目标参数的严重“污染”，现有校正方法多依赖静态数据，泛化能力不足，导致反演精度和可靠性受限。另一方面，基于物理过程的陆面过程模型（LSMs）能够模拟土壤温湿度的时空演变，保证结果的物理一致性，但其精度高度依赖于气象驱动数据的准确性和模型参数的率定，常导致模拟结果存在系统性偏差。为结合观测与模型的优势，传统的数据同化技术（如卡尔曼滤波）常被用于融合遥感观测与物理模型，但在处理GNSS-R与LSM之间的高度非线性关系时力不从心。纯数据驱动的深度学习方法虽擅长挖掘非线性关系，但因缺乏物理机制约束，其预测结果可能违背基本物理规律，可靠性无法保证。综上所述，现有技术无法有效解决GNSS-R信号去噪、物理模型偏差校正以及二者高效协同的难题，迫切需要一种能够将GNSS-R的实时观测、物理模型的机理约束以及深度学习的非线性建模能力有机结合的新方法。

## 发明内容

本发明旨在克服现有技术的不足，提供一种基于GNSS-R与物理模型深度协同的土壤湿度动态估算方法。该方法的核心技术问题在于：如何利用物理模型动态地、机理地校正GNSS-R观测中的误差，以提取更纯净的土壤湿度信号；如何校正物理模型自身的系统性偏差并提升其空间分辨率；以及如何构建一个能够学习并执行观测与模型之间复杂、非线性交互的智能融合框架，以生成物理一致且观测准确的土壤湿度产品。

为解决上述问题，本发明的技术方案概括为：首先，同步获取目标区域的GNSS-R地表反射率数据，并运行物理陆面过程模型（LSM）获取土壤湿度、植被含水量等关键状态变量的“先验”估算场，同时收集相关的辅助地理空间数据。其次，进行物理信息引导的特征工程，即利用LSM输出的动态状态变量（如植被含水量）作为校正因子，对原始GNSS-R数据进行去噪和归一化，旨在物理上剥离植被和地表粗糙度等因素的干扰。再次，将校正后的GNSS-R数据、LSM输出的状态变量场及其他辅助数据，构建成多通道时空数据张量，并输入到一个混合的卷积神经网络（CNN）与长短期记忆网络（LSTM）架构中，以提取空间协同模式并捕捉时间动态演化。最后，通过该深度协同融合模型，生成一个最优融合了观测信息和物理约束的高分辨率土壤湿度“分析”产品，并可结合气象预报数据对未来进行预测。

与现有技术相比，本发明具有显著的有益效果。其一，通过利用物理模型动态输出对GNSS-R信号的主要误差源进行主动校正，显著提升了土壤湿度反演的精度和在不同地表条件下的稳健性。其二，通过深度融合物理模型，确保了最终产品遵循水分和能量平衡等基本物理规律，避免了纯机器学习方法可能产生的、违背物理现实的结果。其三，本方法充分利用GNSS-R的高时间重访特性和CNN强大的空间特征学习能力，能够生成时空分辨率更优的土壤湿度产品。最后，本发明实现了从“数据融合”到“深度协同”的范式转变，深度学习模型在此框架中扮演了一个“学习到的数据同化算子”角色，能够学习并执行观测数据如何非线性地更新和校正物理模型的复杂逻辑，这是传统数据同化技术难以实现的。

## 附图说明

图1为本发明提出的一种基于GNSS-R与物理模型深度协同的土壤湿度动态估算方法的流程示意图。该图清晰地展示了从数据获取到最终产品生成的完整工作流程，包括四个主要模块：（1）多源数据获取与预处理模块；（2）物理信息引导的特征工程模块；（3）时空深度协同模型模块；以及（4）动态更新与预测输出模块。图中的箭头明确指示了数据流向，特别是物理模型与GNSS-R数据之间关键的、双向校正的信息流。

## 具体实施方式

为使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明的具体实施方式进行详细描述。本方法的具体实施包含以下四个核心步骤：

**步骤一：多源数据获取与时空协调**

此步骤旨在为后续处理准备所有必需的数据输入。
1.  **GNSS-R数据获取**：获取星载GNSS-R任务（如CYGNSS）或地基观测站的地表反射率（Reflectivity）原始数据，记为 $\Gamma_{raw}$。该数据具有全天候、高时间分辨率的特点。
2.  **陆面过程模型（LSM）配置与运行**：选用一个物理陆面过程模型（如Noah-MP、CLM等），利用格点化的气象驱动数据（如降水、气温、辐射等）进行驱动，模拟生成覆盖目标区域的“先验”状态变量场。关键输出变量包括多层土壤湿度 $SM_{LSM}$、植被含水量 $VWC_{LSM}$ 和表层土壤温度 $T_{soil, LSM}$。
3.  **辅助数据收集**：收集并处理其他静态或准静态的辅助地理空间数据，包括数字高程模型（DEM）、土壤质地（沙土、壤土、黏土百分比）图、以及由高分辨率光学卫星（如Landsat、Sentinel-2）反演的归一化植被指数（NDVI）。
4.  **时空对齐**：将上述所有数据源通过重采样和地图投影转换，统一到相同的空间网格（例如，1公里分辨率）和时间步长（例如，每日或每6小时）上，确保所有数据在时空维度上严格对齐。

**步骤二：物理信息引导的特征工程**

此步骤是本发明的关键创新，旨在利用LSM的动态物理输出来“净化”GNSS-R观测信号，提取对土壤湿度更敏感的信息。
1.  **植被衰减动态校正**：GNSS-R信号在穿透植被冠层时会发生衰减，其衰减程度主要与植被含水量相关。本发明利用LSM动态模拟的 $VWC_{LSM}$ 来校正此效应。校正后的反射率 $\Gamma_{veg\_corr}$ 按下式计算：
    $$ \Gamma_{veg\_corr} = \Gamma_{raw} \cdot \exp\left(\frac{2 \cdot b \cdot VWC_{LSM}}{\cos(\theta)}\right) $$
    其中，$\Gamma_{raw}$ 是原始GNSS-R反射率；$VWC_{LSM}$ 是LSM模拟的植被含水量（单位：$kg/m^2$）；$b$ 是一个依赖于植被类型的经验系数；$\theta$ 是GNSS信号的入射角。此公式物理意义在于，将观测到的、被植被削弱的信号恢复到无植被覆盖地表的状态。
2.  **地表状态效应校正**：地表粗糙度和土壤冻融状态同样影响反射率。本发明利用LSM模拟的土壤温度 $T_{soil, LSM}$ 作为地表冻融状态的指示器。定义一个地表状态校正因子 $H(T_{soil, LSM})$：
    $$ H(T_{soil, LSM}) = 1 - \alpha \cdot \frac{1}{1 + \exp(-k \cdot T_{soil, LSM})} $$
    其中，$\alpha$ 和 $k$ 是经验参数。该S型函数使得在土壤温度远低于冰点时，校正因子趋近于 $1-\alpha$，而在远高于冰点时趋近于1，从而平滑地对冻融转换期间的信号突变进行校正。最终校正后的反射率 $\Gamma_{final}$ 为：
    $$ \Gamma_{final} = \Gamma_{veg\_corr} \cdot H(T_{soil, LSM}) $$
3.  **构建多通道时空数据张量**：将经过物理校正的GNSS-R反射率 $\Gamma_{final}$、LSM的“先验”输出（$SM_{LSM}$、$VWC_{LSM}$、$T_{soil, LSM}$）以及辅助数据（DEM、土壤质地、NDVI）整合为一个多通道的时空数据立方体（Tensor）。在时间步 $t$ 时，该张量的维度为 `[高度, 宽度, 通道数]`，其中通道数等于所用变量的总数。

**步骤三：构建与训练时空深度协同模型**

采用CNN-LSTM混合架构，学习GNSS-R观测信息与LSM物理状态信息之间的非线性融合与相互校正规律。
1.  **模型架构**：
    * **CNN模块**：对于每一个时间步 $t$ 的输入张量 $X_t$，利用一个二维卷积神经网络（CNN）提取空间特征。CNN由多个卷积层（使用ReLU激活函数）和池化层组成，能够有效识别和整合不同数据源在空间上的协同模式（如地形对土壤湿度的影响）。该模块的输出是一个压缩的空间特征向量 $f_{spatial, t}$。
        $$ f_{spatial, t} = \text{CNN}(X_t) $$
    * **LSTM模块**：将连续多个时间步（例如，过去5天）的空间特征向量序列 $[f_{spatial, t-4}, ..., f_{spatial, t}]$ 输入到一个长短期记忆网络（LSTM）中。LSTM通过其内部的遗忘门、输入门和输出门结构，有效捕捉水文过程（如降水入渗、蒸散发）的时间依赖性和“记忆”效应。
        $$ h_t = \text{LSTM}(f_{spatial, t}, h_{t-1}) $$
        其中 $h_t$ 是LSTM在时间步 $t$ 的隐藏状态，它编码了到当前时刻为止的时空演化历史。
    * **输出层**：将LSTM的最终隐藏状态 $h_t$ 通过一个或多个全连接层（Dense Layer），最终输出在每个网格点上最优融合的土壤湿度估算值 $SM_{final, t}$。
2.  **模型训练**：使用历史时期的多源数据和对应的地面站点实测土壤湿度数据作为真值，对整个端到端模型进行监督训练。采用均方根误差（RMSE）作为损失函数 $L$：
    $$ L = \sqrt{\frac{1}{N} \sum_{i=1}^{N} (SM_{final, i} - SM_{truth, i})^2} $$
    其中，$N$ 是训练样本（时空点）的总数。通过反向传播算法和优化器（如Adam）不断调整网络权重，直至损失函数收敛。

**步骤四：动态同化与预测框架应用**

将训练好的模型应用于业务化的动态估算与预测。
1.  **动态同化更新**：在业务化运行中，模型扮演一个“学习到的数据同化算子”。对于每一个新的时间步 $t$：
    * **预报（Forecast）**：将LSM从 $t-1$ 时刻的最终分析场向前积分一步，得到 $t$ 时刻的“预报”状态场 $SM_{LSM, t}$。
    * **分析（Analysis）**：获取最新的GNSS-R观测 $\Gamma_{raw, t}$，并结合LSM的预报状态进行步骤二的物理特征工程，生成输入张量 $X_t$。将 $X_t$ 和前一时刻的LSTM隐藏状态 $h_{t-1}$ 输入已训练好的模型，生成该时刻最终的、经过观测校正的土壤湿度“分析”场 $SM_{final, t}$。此分析场将作为下一轮预报的初始条件。
2.  **未来预测**：结合未来的气象预报数据（如未来72小时的降水预报）驱动LSM，生成未来的“先验”状态场序列。将该序列输入已训练好的模型，利用模型的自回归能力，可以对未来短期内的土壤湿度时空演变进行预测，为干旱、洪水等灾害的早期预警提供有力支持。

本领域技术人员应理解，本发明不局限于上述具体实施方式。在不脱离本发明精神和范围的情况下，可以对本发明的技术方案进行各种修改和变型，这些修改和变型均落入本发明的保护范围之内。本说明书中未作详细描述的技术细节，均为本领域公知技术。